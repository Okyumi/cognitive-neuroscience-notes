name: Upload Images

on:
  push:
    paths:
      - '.github/workflows/upload-images.yml'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  upload-images:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Remove corrupted images
        run: |
          rm -rf images/
          mkdir -p images
      
      - name: Download and extract images
        run: |
          curl -L -o images.zip "https://files.catbox.moe/isrwjj.zip"
          file images.zip
          unzip -o images.zip -d images/
          rm images.zip
          echo "Images extracted: $(ls images/*.png | wc -l) files"
      
      - name: Commit and push images
        run: |
          git config user.name "Okyumi"
          git config user.email "yd2247@nyu.edu"
          git add images/
          git status
          git diff --cached --stat
          git commit -m "Add extracted course note images (453 PNG files)" || echo "No changes to commit"
          git push
